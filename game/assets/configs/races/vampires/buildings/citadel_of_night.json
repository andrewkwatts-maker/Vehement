{
  "id": "citadel_of_night",
  "type": "building",
  "race": "vampires",
  "name": "Citadel of Night",
  "description": "The ultimate vampire stronghold, shrouded in eternal darkness. Unlocks the most powerful units and abilities.",

  "tags": ["main_hall", "production", "age_advancement", "ultimate"],
  "tier": 3,
  "age_requirement": 3,

  "model": {
    "path": "models/races/vampires/buildings/citadel_of_night.obj",
    "scale": [1.0, 1.0, 1.0]
  },

  "textures": {
    "diffuse": "textures/races/vampires/buildings/citadel_diffuse.png",
    "normal": "textures/races/vampires/buildings/citadel_normal.png",
    "emissive": "textures/races/vampires/buildings/citadel_emissive.png"
  },

  "footprint": {
    "size": [6, 6],
    "entrances": [[3, 0]],
    "visualSize": [18.0, 20.0, 18.0]
  },

  "construction": {
    "cost": {
      "gold": 600,
      "lumber": 300,
      "blood": 100
    },
    "time": 120.0,
    "upgradeFrom": "blood_castle"
  },

  "stats": {
    "maxHealth": 5000,
    "armor": 25,
    "magicResist": 20
  },

  "production": [
    {
      "type": "unit",
      "output": "thrall",
      "cost": {"gold": 75, "food": 1},
      "time": 10.0,
      "maxQueue": 12
    }
  ],

  "researches": [
    {
      "id": "eternal_night",
      "name": "Eternal Night",
      "description": "All vampire units gain permanent night bonuses regardless of time",
      "cost": {"gold": 500, "lumber": 200, "blood": 150, "souls": 25},
      "time": 120.0
    },
    {
      "id": "blood_mastery_supreme",
      "name": "Supreme Blood Mastery",
      "description": "All life steal increased by 10%",
      "cost": {"gold": 400, "blood": 200},
      "time": 90.0
    }
  ],

  "ageAdvancement": {
    "canAdvanceAge": true,
    "availableAges": ["count", "duke", "prince", "lord", "ancient"]
  },

  "abilities": [
    {
      "id": "blood_collection_supreme",
      "name": "Blood Collection",
      "type": "passive",
      "description": "Generates 4 Blood per 10 seconds",
      "effects": {
        "bloodGeneration": 0.4
      }
    },
    {
      "id": "eternal_shroud",
      "name": "Eternal Shroud",
      "type": "passive",
      "description": "Creates permanent night in a large radius around the Citadel",
      "effects": {
        "radius": 1500,
        "permanent": true,
        "grantsNightBonuses": true
      }
    },
    {
      "id": "call_of_the_night",
      "name": "Call of the Night",
      "type": "active",
      "targetType": "area",
      "description": "Summon 6 vampire spawn from the shadows anywhere on the map",
      "cooldown": 180,
      "effects": {
        "summonCount": 6,
        "summonType": "vampire_spawn",
        "duration": 60,
        "globalCast": true
      }
    }
  ],

  "garrison": {
    "capacity": 16,
    "heals_garrisoned": true,
    "heal_rate": 15.0,
    "attack_from_garrison": true,
    "garrisonAttack": {
      "damage": 25,
      "range": 800,
      "attackSpeed": 0.8,
      "lifeSteal": 0.15
    }
  },

  "visionRange": 18.0,

  "requirements": {
    "buildings": ["blood_castle"],
    "upgradeFrom": "blood_castle"
  },

  "unique": true,
  "maxCount": 1,

  "ui": {
    "portrait": "textures/races/vampires/portraits/buildings/citadel_of_night.png",
    "icon": "textures/races/vampires/icons/buildings/citadel_of_night.png",
    "hotkey": "N"
  },

  "dayNightEffects": {
    "night": {
      "healthRegenBonus": 20.0,
      "productionSpeedBonus": 0.3
    }
  }
}
